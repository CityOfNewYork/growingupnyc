!function(e,t,r,a,i,n,s,o,p,_){_&&(r().isotope||tec_debug.warn("TEC Debug: vendor isotope was not loaded before its dependent file tribe-photo-view.js")),r(t).ready(function(){function v(){r(".photo-loader").show(),r("#tribe-events-photo-events").addClass("photo-hidden")}function u(e){r().isotope?(e.isotope({itemSelector:".tribe-events-photo-event",percentPosition:!0,masonry:{columnWidth:".tribe-events-photo-grid-sizer",gutter:".tribe-events-photo-gutter-sizer"}}),e.imagesLoaded().progress(function(){e.isotope("layout")})):r("#tribe-events-photo-events").removeClass("photo-hidden").css("opacity","1")}function b(e){if("change_view"!=tribe_events_bar_action){if(e.preventDefault(),s.ajax_running)return;s.paged=1,s.view="photo",s.popping=!1,n.pre_ajax(function(){g()})}}function g(){if(!s.popping){s.ajax_running=!0,s.filter_cats&&(a.cur_url=r("#tribe-events-header").data("baseurl"));var b=r("#tribe-events-list-hash").val();if(s.params={action:"tribe_photo",tribe_paged:s.paged,tribe_event_display:s.view,featured:n.is_featured()},s.url_params={action:"tribe_photo",tribe_paged:s.paged,tribe_event_display:s.view},a.default_permalinks&&(s.url_params.hasOwnProperty("post_type")||(s.url_params.post_type=p.events_post_type),s.url_params.hasOwnProperty("eventDisplay")||(s.url_params.eventDisplay=s.view)),b.length&&(s.params.hash=b),s.category&&(s.params.tribe_event_category=s.category),r(i).trigger("tribe_ev_serializeBar"),r(i).trigger("serialize-bar.tribe"),n.invalid_date_in_params(s.params))return void(s.ajax_running=!1);r("#tribe-events-header").tribe_spin(),v(),s.params=r.param(s.params),s.url_params=r.param(s.url_params),r(i).trigger("tribe_ev_collectParams"),r(i).trigger("collect-params.tribe"),s.pushstate=!1,s.do_string=!0}o.pushstate&&!s.filter_cats?(_&&tec_debug.time("Photo View Ajax Timer"),r(i).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_photoView_AjaxStart"),r(i).trigger("ajax-start.tribe").trigger("photo-view-ajax-start.tribe"),r.post(TribePhoto.ajaxurl,s.params,function(e){if(s.initial_load=!1,n.enable_inputs("#tribe_events_filters_form","input, select"),e.success){s.ajax_running=!1,a.ajax_response={total_count:parseInt(e.total_count),view:e.view,max_pages:e.max_pages,tribe_paged:e.tribe_paged,timestamp:(new Date).getTime()},r("#tribe-events-list-hash").val(e.hash);var o=r.parseHTML(e.html);r("#tribe-events-content").replaceWith(o),r("#tribe-events-content").prev("#tribe-events-list-hash").remove(),r(".tribe-events-promo").next(".tribe-events-promo").remove(),0==e.max_pages&&r("#tribe-events-header").hide(),s.page_title=r("#tribe-events-header").data("title"),s.view_title=r("#tribe-events-header").data("viewtitle"),t.title=s.page_title,r(".tribe-events-page-title").html(s.view_title),s.do_string&&history.pushState({tribe_params:s.params,tribe_url_params:s.url_params},s.page_title,a.cur_url+"?"+s.url_params),s.pushstate&&history.pushState({tribe_params:s.params,tribe_url_params:s.url_params},s.page_title,a.cur_url),u(r("#tribe-events-photo-events")),r(i).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_photoView_AjaxSuccess"),r(i).trigger("ajax-success.tribe").trigger("photo-view-ajax-success.tribe"),_&&tec_debug.timeEnd("Photo View Ajax Timer")}})):s.url_params.length?e.location=a.cur_url+"?"+s.url_params:e.location=a.cur_url}var l=n.get_url_param("tribe_paged"),c=n.get_url_param("tribe_event_display"),d=r("#tribe-events-photo-events");if(s.view="photo",l&&(s.paged=l),"past"==c&&(s.view="past"),u(d),o.pushstate&&!o.map_view()){var m="action=tribe_photo&tribe_paged="+s.paged;a.params.length&&(m=m+"&"+a.params),s.category&&(m=m+"&tribe_event_category="+s.category),n.is_featured()&&(m+="&featured=1"),history.replaceState({tribe_params:m,tribe_url_params:a.params},"",location.href),r(e).on("popstate",function(e){var t=e.originalEvent.state;t&&(s.do_string=!1,s.pushstate=!1,s.popping=!0,s.params=t.tribe_params,s.url_params=t.tribe_url_params,n.pre_ajax(function(){g()}),n.set_form(s.params))})}r("#tribe-events").on("click","li.tribe-events-nav-next a",function(e){e.preventDefault(),s.ajax_running||("past"==s.view?"1"==s.paged?s.view="photo":s.paged--:s.paged++,s.popping=!1,n.pre_ajax(function(){g()}))}).on("click","li.tribe-events-nav-previous a",function(e){e.preventDefault(),s.ajax_running||("photo"==s.view?"1"==s.paged?s.view="past":s.paged--:s.paged++,s.popping=!1,n.pre_ajax(function(){g()}))}),(o.no_bar()||o.live_ajax()&&o.pushstate)&&r("#tribe-bar-date").on("changeDate",function(e){o.reset_on()||b(e)}),r(i).on("updating-recurrence.tribe",function(){s.popping=!1}),r("#tribe-bar-form").on("submit",function(e){"change_view"!=tribe_events_bar_action&&b(e)}),n.snap("#tribe-events-content-wrapper","#tribe-events-content-wrapper","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a"),r(i).on("run-ajax.tribe",function(){g()}),_&&tec_debug.info("TEC Debug: tribe-events-photo-view.js successfully loaded"),s.view&&_&&tec_debug.timeEnd("Tribe JS Init Timer")})}(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_js_config,tribe_debug);