var tribe_events_pro_admin=tribe_events_pro_admin||{};tribe_events_pro_admin.recurrence={recurrence_count:0,exclusion_count:0,event:{}},function(t,r){"use strict";var n=t(document);r.init=function(){this.init_recurrence()},r.init_recurrence=function(){this.$recurrence_staging=t("#tribe-recurrence-staging"),this.recurrence_tmpl=document.getElementById("tmpl-tribe-recurrence"),this.recurrence_tmpl&&(this.recurrence_template=Handlebars.compile(this.recurrence_tmpl.innerHTML),this.$add_recurrence=t("#tribe-add-recurrence"),this.$recurrence_rules=t(".tribe-event-recurrence-rule"),this.$recurrence_row=t(".recurrence-row.tribe-datetime-block").addClass("tribe-recurrence-exclusion-row--idle"),this.$exclusion_staging=t("#tribe-exclusion-staging"),this.exclusion_tmpl=document.getElementById("tmpl-tribe-exclusion"),this.exclusion_template=Handlebars.compile(this.exclusion_tmpl.innerHTML),this.$add_exclusion=t("#tribe-add-exclusion"),this.$exclusion_rules=t(".tribe-event-recurrence-exclusion"),this.recurrence_errors={days:[],end:[]},this.date_format=tribe_datepicker_opts.dateFormat.toUpperCase(),this.date_format=this.date_format.replace("YY","YYYY"),this.populate_recurrence(tribe_events_pro_recurrence_data),window.Handlebars.registerHelper({tribe_recurrence_select:function(e,r){var n=t("<select />").html(r.fn(this));return e&&n.find("option:selected").attr("selected",!1),n.find('[value="'+e+'"]').attr("selected","selected"),n.html()},tribe_if_in:function(e,r,n){return"undefined"==typeof r&&(r=[]),"undefined"==typeof n&&(n=""),-1!==t.inArray(e,r)?n:""},tribe_if_not_in:function(e,r,n){return"undefined"==typeof r&&(r=[]),"undefined"==typeof n&&(n=""),-1===t.inArray(e,r)?n:""},tribe_checked_if_is:function(e,t){return e===t?"checked":""},tribe_checked_if_is_not:function(e,t){return e!==t?"checked":""},tribe_checked_if_in:function(e,r){return-1!==t.inArray(e,r)?"checked":""}}))},r.attach_behaviors=function(){t(".eventForm").on("submit",".wp-admin.events-cal #post",this.event.submit_validation).on("change",'[data-field="type"]',this.event.recurrence_type_changed).on("change",'[data-field="end-type"]',this.event.recurrence_end_type_changed).on("change",'[data-field="custom-month-number"]',this.event.recurrence_custom_month_changed).on("change",'[data-field="same-time"]',this.event.same_time_changed).on("change",'[data-field="custom-week-day"]',this.event.weekdays_changed).on("change",".recurrence_end_count",this.event.recurrence_end_count_changed).on("change",".recurrence-row, .custom-recurrence-row",this.event.recurrence_row_changed).on("change","#EventStartDate, #EventEndDate, #allDayCheckbox, #EventStartTime, #EventEndTime",this.event.datepicker_updated).on("change","#EventStartTime, #EventEndTime, #allDayCheckbox",this.setup_same_time).on("change","#EventStartDate",this.setup_same_day).on("click","#tribe-add-recurrence",this.event.add_recurrence).on("click","#tribe-add-exclusion",this.event.add_exclusion).on("click",".tribe-event-recurrence .tribe-handle, .tribe-event-exclusion .tribe-handle",this.event.toggle_rule).on("click",".tribe-event-recurrence .tribe-confirm-delete-this, .tribe-event-exclusion .tribe-confirm-delete-this",this.event.delete_rule),t(document).on("click",".tribe-event-recurrence .tribe-delete-this, .tribe-event-exclusion .tribe-delete-this",this.event.delete_rule),t('input[data-field="is_recurring"][value="true"]').length&&(t(".eventForm").on("change",".recurrence-row input, .custom-recurrence-row input, .recurrence-row select, .custom-recurrence-row select",this.event.recurrence_changed),t(".eventForm").on("recurrenceEndChanged",'[data-field="end"]',this.event.recurrence_changed)),t('[data-field="end"]').datepicker("option","onSelect",this.event.datepicker_end_date_changed),t(".recurrence_end, #EventStartDate, #EventEndDate").datepicker("option","onClose",this.event.datepicker_updated),this.set_recurrence_end_min_date(),this.init_buttonset()},r.init_dropdowns=function(){t(".recurrence-row .tribe-dropdown").not(".dropdown-created").tribe_dropdowns()},r.init_buttonset=function(){t(tribe_buttonset.selector.input).trigger("change.tribe_buttonset")},r.add_recurrence=function(e){var n="undefined"==typeof e;"undefined"!=typeof e&&"undefined"!=typeof e.end&&e.end&&(e.end=moment(e.end).format(this.date_format));try{e.custom.date.date&&(e.custom.date.date=moment(e.custom.date.date).format(this.date_format))}catch(a){}this.$recurrence_staging.append(this.recurrence_template(e));var c=this.$recurrence_staging.find(".tribe-event-recurrence");n&&c.addClass("recurrence-new-rule"),c.find('[name*="recurrence[rules][]"],[id*="recurrence_rule_--"],[data-input*="recurrence_rule_--"],[data-depends*="#recurrence_rule_--"]').each(function(){var e=t(this);e.attr("name")&&e.attr("name",e.attr("name").replace(/recurrence\[rules\]\[\]/,"recurrence[rules]["+r.recurrence_count+"]")),e.attr("id")&&e.attr("id",e.attr("id").replace(/recurrence_rule_--/,"recurrence_rule_"+r.recurrence_count)),e.attr("data-input")&&e.attr("data-input",e.attr("data-input").replace(/recurrence_rule_--/,"recurrence_rule_"+r.recurrence_count)).data("input",e.attr("data-input")),e.attr("data-depends")&&e.attr("data-depends",e.attr("data-depends").replace(/#recurrence_rule_--/,"#recurrence_rule_"+r.recurrence_count))}),e||c.find(".tribe-same-time-checkbox").prop("checked",!0),c.find(".tribe-datepicker").datepicker(tribe_datepicker_opts),c.insertBefore(this.$recurrence_staging),this.set_recurrence_end_min_date(),this.set_recurrence_data_attributes(c),this.maybe_relocate_end_date(c),this.adjust_rule_helper_text(c),this.update_rule_recurrence_text(c),this.$recurrence_rules=this.$recurrence_rules.add(c),this.recurrence_count++,this.check_for_useful_rule(),this.setup_intervals(c),this.setup_same_time(),this.setup_same_day(),this.setup_yearly_select(c),this.setup_weekly_select(c),this.init_dropdowns(),"undefined"==typeof e&&this.toggle_rule(c),t("#tribe-recurrence-active.inactive").trigger("click").prop("checked",!0).removeClass("inactive")},r.setup_weekly_select=function(e){var r=t(document.getElementById("EventStartDate")).val(),n=moment(r,this.date_format).isoWeekday(),a=e.find('[data-field="custom-week-day"]');a.filter(":checked").length>0||e.find('[data-field="custom-week-day"][value="'+n+'"]').each(function(){t(this).parent().trigger("click")})},r.setup_yearly_select=function(e){var r=t(document.getElementById("EventStartDate")),n=tribe_dynamic_help_text.datepicker_format;n=n.replace("m","MM").replace("d","DD").replace("Y","YYYY");var a=moment(r.val(),n).format("M"),c=e.find('[data-field="custom-year-month"]');c.val()||c.val(a)},r.setup_intervals=function(e){var t=e.find('[data-field="type"]').val(),r=e.find("input.tribe-recurrence-rule-interval"),n=r.get(0);if(!n.created){var a=1,c=6,i=[];for("Daily"===t?c=6:"Weekly"===t?c=6:"Monthly"===t?c=12:"Yearly"===t&&(c=3),a=1;a<=c;a++)i.push({id:a,text:""+a});r.select2("destroy").removeClass("select2-offscreen").data("options",i),n.created=!0}},r.setup_same_day=function(){t(".tribe-event-recurrence, .tribe-event-exclusion").each(function(){var e=t(this),n=e.find(".recurrence-same-day-text"),a=t(document.getElementById("EventStartDate")),c=r.convert_date_format_php_to_moment(tribe_dynamic_help_text.datepicker_format),i=moment(a.val(),c).format("D");n.html(tribe_events_pro_recurrence_strings.recurrence["same-day-month-"+i])})},r.setup_same_time=function(){t(".tribe-event-recurrence, .tribe-event-exclusion").each(function(){var e=t(this),r=e.find(".recurrence-same-time-text"),n="";if(t("#allDayCheckbox:checked").length)n=tribe_events_pro_recurrence_strings.recurrence["same-time-text-same-all-day"];else{var a=t(document.getElementById("EventStartTime")),c=t(document.getElementById("EventEndTime"));n=tribe_events_pro_recurrence_strings.recurrence["same-time-text-same"].replace("%1$s",a.val()).replace("%2$s",c.val())}r.html(n);var i=e.find(".tribe-timepicker:not(.ui-timepicker-input)");tribe_timepickers.setup_timepickers(i)})},r.maybe_relocate_end_date=function(e){var t=e.find(".recurrence-custom-container"),r=e.find(".recurrence-end-container"),n=e.find(".recurrence_end"),a=e.find('[data-field="type"]').data("value");"Date"===a?t.append(n):r.append(n)},r.check_for_useful_rule=function(){var e=this.$recurrence_rules.filter(":first"),r=!1;this.$recurrence_rules.find('[data-field="type"]').each(function(){var e=t(this);"None"!==e.data("value")&&(r=!0)}),r?e.closest("table").addClass("tribe-has-recurrence-rule"):e.closest("table").removeClass("tribe-has-recurrence-rule")},r.add_exclusion=function(e){var n="undefined"==typeof e;if("undefined"!=typeof e&&"undefined"!=typeof e.end&&e.end){var a=tribe_datepicker_opts.dateFormat.toUpperCase().replace("YY","YYYY");e.end=moment(e.end).format(a)}this.$exclusion_staging.append(this.exclusion_template(e));var c=this.$exclusion_staging.find(".tribe-event-exclusion");n&&c.addClass("exclusion-new-rule"),c.find('[name*="recurrence[exclusions][]"],[id*="exclusion_rule_--"],[data-input*="exclusion_rule_--"],[data-depends*="#exclusion_rule_--"]').each(function(){var e=t(this);e.attr("name")&&e.attr("name",e.attr("name").replace(/recurrence\[exclusions\]\[\]/,"recurrence[exclusions]["+r.exclusion_count+"]")),e.attr("id")&&e.attr("id",e.attr("id").replace(/exclusion_rule_--/,"exclusion_rule_"+r.exclusion_count)),e.attr("data-input")&&e.attr("data-input",e.attr("data-input").replace(/exclusion_rule_--/,"exclusion_rule_"+r.exclusion_count)).data("input",e.attr("data-input")),e.attr("data-depends")&&e.attr("data-depends",e.attr("data-depends").replace(/#exclusion_rule_--/,"#exclusion_rule_"+r.exclusion_count))}),e||c.find(".tribe-same-time-checkbox").prop("checked",!0),c.find(".tribe-datepicker").datepicker(tribe_datepicker_opts),c.insertBefore(this.$exclusion_staging),this.set_recurrence_end_min_date(),this.set_recurrence_data_attributes(c),this.maybe_relocate_end_date(c),this.adjust_rule_helper_text(c),this.update_rule_recurrence_text(c),this.$exclusion_rules=this.$exclusion_rules.add(c),this.exclusion_count++,this.check_for_useful_rule(),this.setup_intervals(c),this.setup_same_time(),this.setup_same_day(),this.setup_yearly_select(c),this.setup_weekly_select(c),this.init_dropdowns(),"undefined"==typeof e&&this.toggle_rule(c)},r.populate_recurrence=function(e){return r.operations_completed=0,r.total_operations=0,"undefined"!=typeof e.rules&&e.rules.length?(r.total_operations=1,r.async_operation(function(e,t){r.add_recurrence(e),t()},e.rules,function(){r.operations_completed+=1,r.populate_completed()}),void("undefined"!=typeof e.exclusions&&e.exclusions.length&&(r.total_operations+=1,r.async_operation(function(e,t){r.add_exclusion(e),t()},e.exclusions,function(){r.operations_completed+=1,r.populate_completed()})))):void r.populate_completed()},r.populate_completed=function(){r.operations_completed===r.total_operations&&setTimeout(function(){r.attach_behaviors(),n.trigger("tribe.dependencies-run"),r.$recurrence_row.removeClass("tribe-recurrence-exclusion-row--idle")})},r.async_operation=function(e,t,n,a){var c=a||0;return c>=t.length?void setTimeout(n):void setTimeout(function(){e(t[c],function(){r.async_operation(e,t,n,c+1)})})},r.adjust_rule_helper_text=function(e){var t=e.find('[data-field="custom-type"] option:selected');e.find(".recurrence-interval-type").text(t.data("plural")),e.find('[data-field="custom-type-text"]').val(t.data("plural"))},r.set_recurrence_data_attributes=function(e){var r=e||this.$recurrence_rules;r.each(function(){var e=t(this),r=null,n=["is_recurring","type","end-type","custom-type","custom-month-number"];for(var a in n)r=e.find('[data-field="'+n[a]+'"]'),"custom-month-number"===n[a]?e.attr("data-recurrence-"+n[a],isNaN(r.val())?"string":"numeric"):"custom-month-number"===n[a]?e.attr("data-recurrence-"+n[a],r.is(":checked")?"yes":"no"):e.attr("data-recurrence-"+n[a],r.val());var c=e.find('[data-field="custom-type"]'),i=null;switch(c.val()){case"Weekly":i="week";break;case"Monthly":i="month";break;case"Yearly":i="year";break;case"Daily":default:i="day"}var d=e.find('[data-field="custom-'+i+'-same-time"]');e.attr("data-recurrence-same-time",d.filter(":checked").length?"yes":"no")})},r.set_recurrence_end_min_date=function(){var e=t("#EventStartDate").val();""!==e&&t(".recurrence_end").attr("placeholder",e).datepicker("option","minDate",e)},r.has_valid_recurrence_days=function(){var e=!0;return this.$recurrence_rules.each(function(n){r.has_valid_recurrence_days_for_rule(t(this))||(e=!1,r.recurrence_errors.days.push(n))}),e},r.has_valid_recurrence_days_for_rule=function(e){var t=e.find('[data-field="custom-interval"]'),r=e.find('[data-field="type"]');return t.val()===parseInt(t.val(),10)||"Custom"!==r.val()},r.has_valid_recurrence_ends=function(){var e=!0;return this.$recurrence_rules.each(function(n){r.has_valid_recurrence_end_for_rule(t(this))||(e=!1,r.recurrence_errors.end.push(n))}),e},r.has_valid_recurrence_end_for_rule=function(e){var t=e.find('[data-field="end"]'),r=e.find('[data-field="end-type"]'),n=e.find('[data-field="type"]');return"None"===n.val()||"On"!==r.val()||t.val()&&!t.hasClass("placeholder")},r.reset_submit_button=function(){t("#publishing-action .button-primary-disabled").removeClass("button-primary-disabled"),t("#publishing-action .spinner").hide()},r.validate_recurrence=function(){var e=!0;return this.has_valid_recurrence_days()||(e=!1,alert(t(".rec-days-error:first").text()),t(".rec-days-error").each(function(e){t.inArray(e,r.recurrence_errors.days)&&t(this).show()})),this.has_valid_recurrence_ends()||(e=!1,alert(t(".rec-end-error:first").text()),t(".rec-end-error").each(function(e){t.inArray(e,r.recurrence_errors.end)&&t(this).show()})),e},r.toggle_rule=function(e,t){"undefined"!==t&&t?"open"===t?e.addClass("tribe-open"):e.removeClass("tribe-open"):e.toggleClass("tribe-open")},r.update_recurrence_text=function(){this.$recurrence_rules.each(function(){r.update_rule_recurrence_text(t(this))}),this.$exclusion_rules.each(function(){r.update_rule_recurrence_text(t(this))})},r.convert_date_format_php_to_moment=function(e){return e.replace("S","o").replace("j","D").replace("F","MMMM").replace("Y","YYYY").replace("m","MM").replace("d","DD")},r.update_rule_recurrence_text=function(e){var r=e.find('[data-field="type"]').val(),n=e.find('[data-field="end-type"] option:selected').val(),a=e.find('[data-field="end-count"]').val(),c="yes"===e.find('[data-field="same-time"]').val(),i=e.find('[data-field="custom-interval"]').val(),d=t(document.getElementById("allDayCheckbox")).prop("checked");if(a||(a=0),r=r.toLowerCase().replace(" ","-"),n=n.toLowerCase().replace(" ","-"),"none"===r||""===r)return void e.find(".tribe-event-recurrence-description").html("");var s=e.closest(".eventForm"),o=this.date_format+" hh:mm a",u=t(document.getElementById("EventStartDate")),l=u.val(),_=t(document.getElementById("EventStartTime")),p=_.val().toUpperCase();l+=" "+p;var f=t(document.getElementById("EventEndDate")),h=f.val(),m=(s.find('[name="EventEndMeridian"] option:selected'),t(document.getElementById("EventEndTime"))),v=m.val().toUpperCase();h+=" "+v;var b=moment(l,o),g=moment(h,o),y=b,x=c?p:e.find(".tribe-field-start_time").val(),k=null,w=null,E=tribe_events_pro_recurrence_strings.date.day_placeholder,C=b.format("D"),$=r;if(d&&!b.isSame(g,"day")?$+="-multi":d&&c&&($+="-allday"),"weekly"===r){var D=[];e.find('[data-field="custom-week-day"]:checked').each(function(){D.push(tribe_events_pro_recurrence_strings.date.weekdays[parseInt(t(this).val(),10)-1])}),0===D.length?k=tribe_events_pro_recurrence_strings.date.day_placeholder:2===D.length?k=D.join(" "+tribe_events_pro_recurrence_strings.date.collection_joiner+" "):(k=D.join(", "),k=k.replace(/(.*),/,"$1, "+tribe_events_pro_recurrence_strings.date.collection_joiner))}else if("monthly"===r){var Y=e.find('[data-field="month-same-day"] option:selected').val(),I=e.find('[data-field="custom-month-number"] option:selected').val(),S=e.find('[data-field="custom-month-day"] option:selected').val();"yes"!==Y&&isNaN(I)?(C=I,E=tribe_events_pro_recurrence_strings.date[I.toLowerCase()+"_x"],E=E.replace("%1$s",tribe_events_pro_recurrence_strings.date.weekdays[parseInt(S,10)-1])):(I=C,$+="-numeric")}else if("yearly"===r){var Y=e.find('[data-field="year-same-day"] option:selected').val(),I=e.find('[data-field="custom-year-month-number"]').val(),S=e.find('[data-field="custom-year-month-day"]').val(),T=[],B=e.find('[data-field="custom-year-month"]').val().split(",");t.each(B,function(e,t){T.push(tribe_events_pro_recurrence_strings.date.months[parseInt(t,10)-1])}),0===T.length?w=tribe_events_pro_recurrence_strings.date.month_placeholder:2===T.length?w=T.join(" "+tribe_events_pro_recurrence_strings.date.collection_joiner+" "):(w=T.join(", "),w=w.replace(/(.*),/,"$1, "+tribe_events_pro_recurrence_strings.date.collection_joiner)),"yes"!==Y&&isNaN(I)?(C=I,E=tribe_events_pro_recurrence_strings.date[I.toLowerCase()+"_x"],E=E.replace("%1$s",tribe_events_pro_recurrence_strings.date.weekdays[parseInt(S,10)-1])):(I=C,$+="-numeric")}else if("date"===r){var M=e.find("input.tribe-datepicker").val();if(!M)return void e.find(".tribe-event-recurrence-description").html("");var y=moment(M,o)}$+="date"===r?"-on":"after"===n?"-after":"never"===n?"-never":"-on",d&&!c&&($+="-at"),"undefined"==typeof tribe_events_pro_recurrence_strings.recurrence[$]&&$.endsWith("-at")&&($=$.replace(/-at$/,""));var j=tribe_events_pro_recurrence_strings.recurrence[$];if("undefined"==typeof j)return void e.find(".tribe-event-recurrence-description").html("");var N=e.find('[data-field="end"]').val();N||(N=e.find('[data-field="end"]').attr("placeholder"));var F=moment(N,o),H=this.convert_date_format_php_to_moment(tribe_dynamic_help_text.date_with_year);j=j.replace("[count]",a),j=j.replace("[day_number]",C),j=j.replace("[days_of_week]",k),j=j.replace("[month_day_description]",E),j=j.replace("[month_names]",w),j=j.replace("[month_number]",I),j=j.replace("[interval]",i),j=j.replace("[series_end_date]",F.format(H)),j=j.replace("[start_date]",b.format(H)),j=j.replace("[start_time]",x),j=j.replace("[single_date]",y.format(H)),j=j.replace("1 day(s)","day"),j=j.replace("1 week(s)","week"),j=j.replace("1 month(s)","month"),j=j.replace("1 year(s)","year"),j=j.replace("day(s)","days"),j=j.replace("week(s)","weeks"),j=j.replace("month(s)","months"),j=j.replace("year(s)","years"),e.find(".tribe-event-recurrence-description").html(j)},r.event.add_recurrence=function(e){e.preventDefault(),r.add_recurrence()},r.event.add_exclusion=function(e){e.preventDefault(),r.add_exclusion()},r.event.recurrence_type_changed=function(){var e=t(this),n=e.closest(".tribe-event-recurrence, .tribe-event-exclusion"),a=(e.find("option:selected").val(),n.find(".occurence-count-text")),c=parseInt(n.find(".recurrence_end_count").val(),10),i=e.data("plural");n.find(".recurrence_end_count").val(c),(isNaN(c)||0>=c)&&(n.find(".recurrence_end_count").val(1),c=1),1===c&&(i=e.data("single")),a.text(i),n.find('[data-field="occurrence-count-text"]').val(a.text()),r.set_recurrence_data_attributes(n),r.maybe_relocate_end_date(n),r.check_for_useful_rule(),r.setup_intervals(n),r.setup_yearly_select(n),r.setup_weekly_select(n),r.init_dropdowns();var d=e.closest(".tribe-buttonset").parent();d.find(".tribe-dependent:not(.tribe-dependency)").dependency(),r.toggle_rule(n,"open")},r.event.recurrence_end_type_changed=function(){var e=t(this),n=e.closest(".tribe-event-recurrence");r.set_recurrence_data_attributes(n)},r.event.recurrence_changed=function(){var e=t(this),n=e.closest(".tribe-event-recurrence, .tribe-event-exclusion");n.attr("data-recurrence-changed","yes"),r.toggle_rule(n,"open")},r.event.recurrence_end_count_changed=function(){var e=t(this),r=e.closest(".tribe-event-recurrence, .tribe-event-exclusion");r.find('[data-field="type"]').change()},r.event.recurrence_custom_month_changed=function(){var e=t(this),n=e.closest(".tribe-event-recurrence");r.set_recurrence_data_attributes(n)},r.event.submit_validation=function(){if(!tribe_events_pro_admin.validate_recurrence())return e.preventDefault(),e.stopPropagation(),tribe_events_pro_admin.reset_submit_button(),!1},r.event.datepicker_updated=function(){tribe_events_pro_admin.recurrence.update_recurrence_text(),tribe_events_pro_admin.recurrence.set_recurrence_end_min_date()},r.event.datepicker_end_date_changed=function(){t(this).removeClass("placeholder"),t(this).trigger("recurrence-end-changed.tribe")},r.event.recurrence_row_changed=function(){var e=t(".recurrence-pattern-description-row");e.is(":visible")||e.show(),tribe_events_pro_admin.recurrence.update_recurrence_text()},r.event.same_time_changed=function(){var e=t(this),n=e.closest(".tribe-event-recurrence, .tribe-event-exclusion");r.set_recurrence_data_attributes(n)},r.event.weekdays_changed=function(){var e=t(this),n=e.closest(".tribe-event-recurrence, .tribe-event-exclusion");r.set_recurrence_data_attributes(n),r.update_rule_recurrence_text(n)},r.event.toggle_rule=function(){var e=t(this);r.toggle_rule(e.closest(".tribe-event-recurrence, .tribe-event-exclusion"))},r.event.delete_rule=function(e){e.preventDefault();var n=t(this),a=n.closest(".tribe-event-recurrence, .tribe-event-exclusion"),c=tribe_events_pro_recurrence_strings.recurrence["delete-confirm"],i=tribe_events_pro_recurrence_strings.recurrence["delete-cancel"],d={"delete":{text:c,click:function(){t(this).dialog("close"),a.fadeOut(500,function(){a.remove(),tribe_events_pro_admin.recurrence.update_recurrence_text()})}},cancel:{text:i,click:function(){r.event.close_delete_confirmation_dialog(t(this))}}},s=t("#tribe-row-delete-dialog");a.is(".tribe-event-recurrence")?s.addClass("rule-dialog").removeClass("exclusion-dialog"):s.addClass("exclusion-dialog").removeClass("rule-dialog"),t(".delete-dialog-open").length&&r.event.close_delete_confirmation_dialog(s),s.dialog({dialogClass:"tribe-row-delete-dialog",closeOnEscape:!0,resizable:!1,height:a[0].offsetHeight,width:a[0].offsetWidth,buttons:d,position:{my:"center",at:"center",of:a},open:function(){var e=t(".tribe-row-delete-dialog"),n=e.find(".ui-dialog-buttonset button"),c=e.find(".ui-dialog-content");a.fadeTo(100,.1),c.css({height:"auto","min-height":"1.5rem"}),t(n[0]).removeClass().addClass("button button-red"),t(n[1]).removeClass().addClass("button button-secondary"),a.addClass("delete-dialog-open"),t("body").on("click",r.event.close_dialogs),t(window).on("resize",r.event.close_dialogs)},close:function(){a.removeClass("delete-dialog-open"),a.fadeTo(100,1),t("body").off("click",r.event.close_dialogs),t(window).off("resize",r.event.close_dialogs)}})},r.event.close_delete_confirmation_dialog=function(e){e&&e.dialog("isOpen")&&e.dialog("close")},r.event.close_dialogs=function(e){var n=t("#tribe-row-delete-dialog");n.length&&n.dialog("isOpen")&&!t(e.target).is(".ui-dialog, a")&&!t(e.target).closest(".ui-dialog").length&&(e.preventDefault(),e.stopPropagation(),r.event.close_delete_confirmation_dialog(n))},t(function(){r.init()})}(jQuery,tribe_events_pro_admin.recurrence);